# 3주차 연구일지

## 1. 연구 개요

- **연구 기간:** 2025년 3월 19일 ~ 2025년 3월 25일
- **프로젝트 이름:** 서버 클라이언트 구조의 CD Measurer/Aligner 구현 (HBS Solution 기업 연계)

- **연구 목표:**
  - CMake를 활용한 자동 환경 설정
  - TCP/IP 통신을 활용한 클라이언트-서버 데이터 송수신
  - MySQL을 이용한 데이터 관리 및 로깅 시스템 구축
  - MFC 기반 GUI 개발 및 사용자 인터페이스 개선

---

## 전반적인 프로그램 흐름
1. **프로그램 실행** 
- MFC 기반의 GUI 프로그램 실행
- OpenCV를 초기화하고 필요한 라이브러리 로드
    - OpenCV - 영상 처리에 사용할 수 있는 오픈 소스 라이브러리
- 서버와 통신하기 위한 네트워크 설정

2. **서버 - Target Image 업로드**
- 기준이 되는 Target Image (템플릿 이미지)를 선택하여 서버에 업로드

3. **서버 → 클라이언트 얼라인(Align) 요청**
- 얼라인(정렬) 수행을 위한 명령을 서버로부터 수신
- 얼라인 요청 시, 현재 클라이언트가 가지고 있는 이미지(카메라로 촬영할 이미지)와 비교하기 위한 준비 작업 수행.

4. **클라이언트 - 카메라 연동** 

- OpenCV를 이용하여 카메라에서 실시간 영상 스트리밍.
- Masking 적용 → 배경 제거, 노이즈 감소
- 카메라 보정(Gain, 밝기 조절 등) 기능

5. **Pattern matching(템플릿 처리)** 
    
- Mark Detection을 위해 활용
    
- 입력 이미지에서 특정 패턴(템플릿)을 찾아 위치를 검출하는 과정
    
- Template Matching 방식 (템플릿 매칭)
      - 기준이 되는 템플릿 이미지를 사용하여 입력 이미지에서 유사한 부분을 찾음.

6. **Mark Detect (마크 검출) - Align 연산 및 측정을 위한 기준점을 찾기 위해 사용**
    - 패턴 매칭을 통해 찾은 마크를 바탕으로 위치 정보 확보
    - 특정 마크가 올바른 위치에 있는지 확인

7. **Align 처리 및 CD 측정**
- Mark Detection 결과를 이용해 이미지 전체를 정렬
    - 정렬 후 거리 측정 알고리즘 수행 (Critical Dimension, CD 측정)
        
        - 특정 영역의 거리, 폭, 크기 등을 정밀하게 측정하는 과정
        
        - 이미지 내 특정 영역의 거리 측정
        - Geometry 알고리즘을 활용하여 오차를 보정하고 측정 정확도를 높임
            - Geometry(계산 기하 알고리즘) - 거리, 각도, 변형 등을 계산하는 수학적 알고리즘

8. 클라이언트 결과 출력 및 서버로 결과 전송 (이미지 및 결과 통계 기능)
9. 서버 - DB 데이터 저장

---

## 2. 연구 진행 내용

- **TCP/IP 통신 프로토콜 설계**
  - 클라이언트-서버 간 데이터 송수신 방식 연구
  - 패킷 구조 및 오류 처리 방식 설계

- **데이터베이스 설계**
  - MySQL을 활용한 테이블 구조 설계
  - 검사 결과 및 로깅 시스템 구축 방안 논의

- **OpenCV 기반 이미지 처리**
  - 패턴 매칭 및 거리 측정 알고리즘 기초 구현
  - 이미지 전처리(그레이스케일 변환, 노이즈 제거) 테스트 수행

- **MFC GUI 개발**
  - 프로젝트 UI 구조 설계 및 초기 화면 구성
  - 패턴 등록 및 시뮬레이션 기능 개발 기획

---


## 3. 문제점 및 해결 방안

- **TCP 통신 연결 지연 발생** → 패킷 최적화 및 비동기 방식 적용 검토
- **이미지 처리 속도 문제** → 멀티스레딩 도입 및 OpenCV 최적화 연구
- **데이터베이스 중복 데이터 문제** → 정규화를 통한 구조 개선 진행

---

## 4. 향후 연구 계획

- TCP/IP 통신 구현 완료 및 데이터 송수신 테스트
- OpenCV 이미지 처리 알고리즘 개선 및 최적화
- MySQL 데이터 연동 및 저장 기능 개발
- GUI 화면 개선 및 기능 연결 작업

---

## 5. 참고 자료

- [GitHub 협업 가이드](https://docs.github.com/en/github)
- [Basler 공식 Tool 튜토리얼 매뉴얼](https://www.baslerweb.com/ko-kr/learning/tutorials/)
- [OpenCV Forum C++ 카테고리](https://forum.opencv.org/c/c/9)
- [OpenCV 공식 문서](https://docs.opencv.org/)
- [MFC 공식 문서](https://learn.microsoft.com/ko-kr/cpp/mfc/mfc-concepts?view=msvc-170)
- [MySQL 공식 문서](https://dev.mysql.com/doc/)
- HBS Solution 제공 프로젝트 PPT

---

이 문서는 연구 진행 상황에 따라 업데이트될 수 있습니다.

